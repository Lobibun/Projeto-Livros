@model IEnumerable<LivroCDF.Models.Livro>

@{
    ViewData["Title"] = "Catálogo de Livros";
}

<div class="container mt-4">

    <div class="d-flex justify-content-between align-items-center mb-4">
        <h2 class="text-primary fw-bold mb-0">
            <i class="bi bi-book"></i> @ViewData["Title"]
        </h2>
        <a asp-action="Create" class="btn btn-primary shadow-sm">
            <i class="bi bi-plus-lg"></i> Novo Título
        </a>
    </div>

    <div class="card bg-light mb-4 shadow-sm border-0">
        <div class="card-body py-3">
            <div class="row">
                <div class="col-md-6">
                    <label class="form-label small fw-bold text-muted mb-1">Pesquisar Livro</label>
                    <div class="input-group">
                        <span class="input-group-text bg-white border-end-0 text-muted">
                            <i class="bi bi-search"></i>
                        </span>
                        <input type="text" id="filtroTexto" class="form-control border-start-0"
                               placeholder="Digite o Título, Autor ou ISBN..." />
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div id="containerTabela">
        <partial name="_TabelaLivros" model="Model" />
    </div>

</div>

@section Scripts {
    <script>
        $(document).ready(function () {
            // Monitora a digitação no campo de busca
            $("#filtroTexto").on("keyup", function () {
                var termo = $(this).val();

                // Animação visual de "carregando"
                $("#containerTabela").css("opacity", "0.5");

                $.get("/Livros/FiltrarCatalogo", { termo: termo }, function (data) {
                    $("#containerTabela").html(data);
                    $("#containerTabela").css("opacity", "1");
                }).fail(function() {
                    alert("Erro ao filtrar livros.");
                    $("#containerTabela").css("opacity", "1");
                });
            });
        });
    </script>
}